---
title: Tutorials
subttitle: Using BioDeepTime in analytical code
bibliography: 'bibliography.bib'
format:
  gfm: 
    variant: +yaml_metadata_block
permalink: /tutorials/
layout: page
---


```{r setup, include=FALSE, echo=FALSE}
knitr::opts_chunk$set(echo = TRUE)
library(divDyn)
```

The tutorial here represents the absolute basics of using the BioDeepTime database. More elaborate tutorials will be made available on [Evolv-ED](https://www.evolv-ed.net/databases/registry/biodeeptime.html).

Add `toc: true` to the metadata of the .md file for a table of contents.

## The Data

### Download

The BioDeepTime database is made available through the 'chronosphere' research data API. The [R client](https://cran.r-project.org/package=chronosphere) to access data can be installed from the CRAN servers with:


```{r chroninst, message=FALSE, eval=FALSE, echo=TRUE}
install.packages("chronosphere")
```

The most up-to-date version of the denormalized BioDeepTiem database can be accessed with: 

```{r download}
# attach package
library(chronosphere)

# download data, verbose=FALSE hides the default chatter 
bdt <- fetch("biodeeptime", verbose=FALSE)
```

Note that this table is rather large and might take a bit of time to load. The accessible data items can be downloaded with (`datasets("biodeeptime")`).

### Structure

The default representation of the denormalized table is a `data.frame`, where every row represents one record or biogeographic observation (the presence of a taxon in a sample).

```{r str}
str(bdt)
```


## Basic analysis

The number of records in the database: 

```{r, dbs}
```

```{r, echo=FALSE, include=FALSE}
##### THIS CHUNK IS NOT PART OF THE TUTORIAL - this creates the summary statistics on the webpage!!!!
summ <- data.frame(
	records=nrow(bdt),
	db=length(table(bdt$db)),
	series=length(table(bdt$seriesID)), 
	samples=length(table(bdt$sampleID)), 
	taxa=length(table(bdt$analyzedTaxon)), 
	from_ma=round(max(bdt$age)/1e4)/100, 
	to_year=1950-min(bdt$age) 
)
write.csv(summ, file="../_data/summary.csv")
##### THIS CHUNK IS NOT PART OF THE TUTORIAL - this creates the summary statistics on the webpage!!!!
```

Regular Quarto-stlye Rmarkdown follows from here.

We can have a citation here: such as [@kocsis2019package]

# References

