<!DOCTYPE html>




<html
 dir="ltr"
 lang="en"
 >
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta name="theme-color" content=#ffffff>
    <link rel="stylesheet" href="/assets/css/app.css">
    <link rel="shortcut icon" type="image/png"
           href="/favicon.png" 
    />
    <script defer src="https://unpkg.com/alpinejs@3.9.0/dist/cdn.min.js"></script>
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@5/css/all.min.css">
    
        <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bulma-social@1/bin/bulma-social.min.css">
    
    <!-- Begin Jekyll SEO tag v2.8.0 -->
<title>Tutorials | BioDeepTime</title>
<meta name="generator" content="Jekyll v4.2.2" />
<meta property="og:title" content="Tutorials" />
<meta property="og:locale" content="en_US" />
<meta name="description" content="Write an awesome description for your new site here. You can edit this line in _config.yml. It will appear in your document head meta (for Google search results) and in your feed.xml site description." />
<meta property="og:description" content="Write an awesome description for your new site here. You can edit this line in _config.yml. It will appear in your document head meta (for Google search results) and in your feed.xml site description." />
<link rel="canonical" href="https://biodeeptime.github.io/tutorials/" />
<meta property="og:url" content="https://biodeeptime.github.io/tutorials/" />
<meta property="og:site_name" content="BioDeepTime" />
<meta property="og:type" content="website" />
<meta name="twitter:card" content="summary" />
<meta property="twitter:title" content="Tutorials" />
<script type="application/ld+json">
{"@context":"https://schema.org","@type":"WebPage","description":"Write an awesome description for your new site here. You can edit this line in _config.yml. It will appear in your document head meta (for Google search results) and in your feed.xml site description.","headline":"Tutorials","url":"https://biodeeptime.github.io/tutorials/"}</script>
<!-- End Jekyll SEO tag -->

    <!-- head scripts --></head>

  <body>
    <nav class="navbar is-primary " x-data="{ openNav: false }">
    <div class="container">
        <div class="navbar-brand">
            <a href="/" class="navbar-item">
              <img src="https://biodeeptime.github.io/images/logo.png" style="margin-right:5px">
			  BioDeepTime
            </a>
            <a role="button" class="navbar-burger burger" aria-label="menu" aria-expanded="false" data-target="navMenu" :class="{ 'is-active': openNav }" x-on:click="openNav = !openNav">
                <span aria-hidden="true"></span>
                <span aria-hidden="true"></span>
                <span aria-hidden="true"></span>
            </a>
        </div>
        <div class="navbar-menu" id="navMenu" :class="{ 'is-active': openNav }">
            <div class="navbar-start">

                
                
                    
                    <a href="/about/" class="navbar-item ">About</a>
                    
                
                    
                    <div class="navbar-item has-dropdown is-hoverable ">
                        <a href="" class="navbar-link ">Team</a>
                        <div class="navbar-dropdown">
                            
                            <a href="/team/people/" class="navbar-item ">People</a>
                            
                            <a href="/team/workshops/" class="navbar-item ">Workshops</a>
                            
                            <a href="/team/funding/" class="navbar-item ">Funding</a>
                            
                        </div>
                    </div>
                    
                
                    
                    <div class="navbar-item has-dropdown is-hoverable ">
                        <a href="" class="navbar-link ">Database</a>
                        <div class="navbar-dropdown">
                            
                            <a href="/database/structure/" class="navbar-item ">Structure</a>
                            
                            <a href="/database/contributing/" class="navbar-item ">Contributors</a>
                            
                            <a href="/database/milestones/" class="navbar-item ">Milestones</a>
                            
                            <a href="/database/access/" class="navbar-item ">Access</a>
                            
                            <a href="/database/attribution/" class="navbar-item ">Attribution</a>
                            
                        </div>
                    </div>
                    
                
                    
                    <a href="/tutorials/" class="navbar-item is-active">Tutorials</a>
                    
                
                    
                    <a href="/publications/" class="navbar-item ">Publications</a>
                    
                
                    
                    <a href="/contribute/" class="navbar-item ">Contribute!</a>
                    
                
                    
                    <a href="/contact/" class="navbar-item ">Contact</a>
                    
                
                
            </div>

            <div class="navbar-end">
                
            </div>

        </div>
    </div>
</nav>

    
        <section class="hero  is-medium  is-bold is-primary" >
    <div class="hero-body ">
        <div class="container">
		  <div class="columns is-vcentered">
			<div class="column is-7">
			  <h1 class="title is-2">Tutorials</h1>
			  <p class="subtitle is-3"></p>
			  
			</div>
			<div class="column is-2" style="text-align:center">
			  <a href="https://biodeeptime.github.io"><img src="https://biodeeptime.github.io/images/logo.png" width="400px"></a>
			</div>
			</div>
        </div>
    </div>
</section>

    
    


    <section class="section">
        <div class="container">
            <div class="columns is-multiline">
                
                <div class="column is-12">
                    
                    
                    
                    
                    
<div class="content">
    <p>The tutorial here represents the absolute basics of using the
BioDeepTime database. More elaborate tutorials will be made available on
<a href="https://www.evolv-ed.net/databases/registry/biodeeptime.html">Evolv-ED</a>.</p>

<p>Add <code class="language-plaintext highlighter-rouge">toc: true</code> to the metadata of the .md file for a table of contents.</p>

<h2 id="the-data">The Data</h2>

<h3 id="download">Download</h3>

<p>The BioDeepTime database is made available through the ‘chronosphere’
research data API. The <a href="https://cran.r-project.org/package=chronosphere">R
client</a> to access data
can be installed from the CRAN servers with:</p>

<div class="language-r highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">install.packages</span><span class="p">(</span><span class="s2">"chronosphere"</span><span class="p">)</span><span class="w">
</span><span class="n">install.packages</span><span class="p">(</span><span class="s2">"tidyverse"</span><span class="p">)</span><span class="w">
</span></code></pre></div></div>

<p>The most up-to-date version of the denormalized BioDeepTiem database can
be accessed with:</p>

<div class="language-r highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1"># attach package</span><span class="w">
</span><span class="n">library</span><span class="p">(</span><span class="n">chronosphere</span><span class="p">)</span><span class="w">
</span></code></pre></div></div>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>Chronosphere - Evolving Earth System Variables
Important: never fetch data as a superuser / with admin. privileges!

Note that the package was split for efficient maintenance and development:
 - Plate tectonic calculations -&gt; package 'rgplates'
 - Arrays of raster and vector spatials -&gt; package 'via'
</code></pre></div></div>

<div class="language-r highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">library</span><span class="p">(</span><span class="n">tidyverse</span><span class="p">)</span><span class="w"> </span><span class="c1"># for data manipulation</span><span class="w">
</span></code></pre></div></div>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>── Attaching packages
───────────────────────────────────────
tidyverse 1.3.2 ──

✔ ggplot2 3.3.6      ✔ purrr   0.3.4 
✔ tibble  3.1.8      ✔ dplyr   1.0.10
✔ tidyr   1.2.0      ✔ stringr 1.4.0 
✔ readr   2.1.2      ✔ forcats 0.5.1 
── Conflicts ────────────────────────────────────────── tidyverse_conflicts() ──
✖ dplyr::collapse() masks divDyn::collapse()
✖ tidyr::fill()     masks divDyn::fill()
✖ dplyr::filter()   masks stats::filter()
✖ dplyr::lag()      masks stats::lag()
✖ dplyr::slice()    masks divDyn::slice()
</code></pre></div></div>

<div class="language-r highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1"># download data, verbose=FALSE hides the default chatter </span><span class="w">
</span><span class="n">bdt</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">fetch</span><span class="p">(</span><span class="s2">"biodeeptime"</span><span class="p">,</span><span class="w"> </span><span class="n">verbose</span><span class="o">=</span><span class="kc">FALSE</span><span class="p">)</span><span class="w">
</span></code></pre></div></div>

<p>Note that this table is rather large and might take a bit of time to
load. The accessible data items can be downloaded with
(<code class="language-plaintext highlighter-rouge">datasets("biodeeptime")</code>).</p>

<h3 id="structure">Structure</h3>

<p>The default representation of the denormalized table is a <code class="language-plaintext highlighter-rouge">data.frame</code>,
where every row represents one record or biogeographic observation (the
presence of a taxon in a sample).</p>

<div class="language-r highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">str</span><span class="p">(</span><span class="n">bdt</span><span class="p">)</span><span class="w">
</span></code></pre></div></div>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>'data.frame':   7437847 obs. of  39 variables:
 $ db                : chr  "Neotoma" "Neotoma" "Neotoma" "Neotoma" ...
 $ seriesID          : chr  "TS_1" "TS_1" "TS_1" "TS_1" ...
 $ seriesOriginalName: chr  "Konus Exposure, Adycha River" "Konus Exposure, Adycha River" "Konus Exposure, Adycha River" "Konus Exposure, Adycha River" ...
 $ seriesOriginalID  : chr  "11" "11" "11" "11" ...
 $ long              : num  136 136 136 136 136 ...
 $ lat               : num  67.8 67.8 67.8 67.8 67.8 ...
 $ depthUnit         : chr  "cmbct" "cmbct" "cmbct" "cmbct" ...
 $ ageModel          : chr  "4" "4" "4" "4" ...
 $ reason            : chr  "Community analysis" "Community analysis" "Community analysis" "Community analysis" ...
 $ sampleID          : chr  "S_1" "S_1" "S_1" "S_1" ...
 $ sampleOriginalID  : chr  "158" "158" "158" "158" ...
 $ sampleOriginalName: chr  NA NA NA NA ...
 $ depth             : num  0 0 0 0 0 0 0 0 0 0 ...
 $ age               : num  1321 1321 1321 1321 1321 ...
 $ ageProc           : chr  "bchron" "bchron" "bchron" "bchron" ...
 $ ageOld            : num  2463 2463 2463 2463 2463 ...
 $ ageYoung          : num  355 355 355 355 355 ...
 $ timeOriginalUnit  : chr  "Radiocarbon years BP" "Radiocarbon years BP" "Radiocarbon years BP" "Radiocarbon years BP" ...
 $ timeOriginal      : num  1000 1000 1000 1000 1000 1000 1000 1000 1000 1000 ...
 $ timeOriginalOld   : num  NA NA NA NA NA NA NA NA NA NA ...
 $ timeOriginalYoung : num  NA NA NA NA NA NA NA NA NA NA ...
 $ waterDepth        : num  NA NA NA NA NA NA NA NA NA NA ...
 $ preservation      : chr  NA NA NA NA ...
 $ samplingEffort    : num  NA NA NA NA NA NA NA NA NA NA ...
 $ minimumMesh       : num  NA NA NA NA NA NA NA NA NA NA ...
 $ maximumMesh       : num  NA NA NA NA NA NA NA NA NA NA ...
 $ environment       : chr  "Terrestrial or Freshwater" "Terrestrial or Freshwater" "Terrestrial or Freshwater" "Terrestrial or Freshwater" ...
 $ samplingEffortType: chr  NA NA NA NA ...
 $ totalCount        : num  809 809 809 809 809 809 809 809 809 809 ...
 $ taxonID           : int  4 10 3 11 8 1 13 12 5 9 ...
 $ analyzedTaxon     : chr  "Valeriana" "Onagraceae" "Ericaceae" "Cyperaceae" ...
 $ species           : chr  NA NA NA NA ...
 $ genus             : chr  NA NA NA NA ...
 $ openNomenclature  : chr  NA NA NA NA ...
 $ analyzedRank      : chr  NA NA NA NA ...
 $ group             : chr  "Plants" "Plants" "Plants" "Plants" ...
 $ abundance         : num  2 6 2 7 5 1 22 12 3 5 ...
 $ abundanceUnit     : chr  "count" "count" "count" "count" ...
 $ refID             : chr  "2" "2" "2" "2" ...
 - attr(*, "chronosphere")=List of 13
  ..$ dat         : chr "biodeeptime"
  ..$ var         : chr "denormalized"
  ..$ res         : logi NA
  ..$ ver         : num 1
  ..$ datafile    : chr "biodeeptime.rds"
  ..$ item        : int 702
  ..$ reference   : chr "Jansen A. Smith, Marina C. Rillo, Ádám T. Kocsis, Maria Dornelas, David Fastovich, Huai-Hsuan M. Huang, Lukas J"| __truncated__
  ..$ bibtex      : chr "@misc{jansen_a_smith_2023_8154672,\n author = {Jansen A. Smith and\nMarina C. Rillo and\nÁdám T. Kocsis and\nMa"| __truncated__
  ..$ downloadDate: POSIXct[1:1], format: "2023-07-18 13:01:36"
  ..$ publishDate : chr "2023-07-12"
  ..$ infoURL     : logi NA
  ..$ API         : logi NA
  ..$ additional  : list()
</code></pre></div></div>

<h2 id="basic-analyses">Basic analyses</h2>

<p>The number of time series in the database:</p>

<div class="language-r highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nf">length</span><span class="p">(</span><span class="n">unique</span><span class="p">(</span><span class="n">bdt</span><span class="o">$</span><span class="n">seriesID</span><span class="p">))</span><span class="w">
</span></code></pre></div></div>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>[1] 10062
</code></pre></div></div>

<p>The number of records in the database:</p>

<div class="language-r highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nf">length</span><span class="p">(</span><span class="n">bdt</span><span class="o">$</span><span class="n">db</span><span class="p">)</span><span class="w">
</span></code></pre></div></div>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>[1] 7437847
</code></pre></div></div>

<p>The number of unique sampling locations:</p>

<div class="language-r highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">nrow</span><span class="p">(</span><span class="n">unique</span><span class="p">(</span><span class="n">bdt</span><span class="p">[,</span><span class="w"> </span><span class="nf">c</span><span class="p">(</span><span class="s2">"long"</span><span class="p">,</span><span class="w"> </span><span class="s2">"lat"</span><span class="p">)]))</span><span class="w">
</span></code></pre></div></div>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>[1] 8752
</code></pre></div></div>

<p>The oldest record (relative to 1950) in each database:</p>

<div class="language-r highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">bdt</span><span class="w"> </span><span class="o">%&gt;%</span><span class="w"> </span><span class="n">group_by</span><span class="p">(</span><span class="n">db</span><span class="p">)</span><span class="w"> </span><span class="o">%&gt;%</span><span class="w"> </span><span class="n">summarize</span><span class="p">(</span><span class="n">max</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">max</span><span class="p">(</span><span class="n">age</span><span class="p">))</span><span class="w">
</span></code></pre></div></div>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code># A tibble: 9 × 2
  db                               max
  &lt;chr&gt;                          &lt;dbl&gt;
1 BioTIME                         49.4
2 Direct uploads             1146200  
3 Geobiodiversity Database 451050000. 
4 MARBEN                    77200000  
5 Neotoma                   23900000  
6 Neptune SandBox          151075752  
7 Paleobiology Database    150889174. 
8 SedTraps                       -28.4
9 Triton                    65997000  
</code></pre></div></div>

<p>Finding the mean age (relative to 1950) of a sample from modern
databases (BioTIME and SedTraps):</p>

<div class="language-r highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">modern</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">bdt</span><span class="w"> </span><span class="o">%&gt;%</span><span class="w">
  </span><span class="n">filter</span><span class="p">(</span><span class="n">db</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="s2">"BioTIME"</span><span class="w"> </span><span class="o">|</span><span class="w"> </span><span class="n">db</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="s2">"SedTraps"</span><span class="p">)</span><span class="w"> </span><span class="c1">## filtering to only modern data</span><span class="w">

</span><span class="n">mean</span><span class="p">(</span><span class="n">modern</span><span class="o">$</span><span class="n">age</span><span class="p">)</span><span class="w"> 
</span></code></pre></div></div>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>[1] -44.50505
</code></pre></div></div>

<p>Finding the mean age (relative to 1950) of a sample from fossil
databases:</p>

<div class="language-r highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">fossil</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">bdt</span><span class="w"> </span><span class="o">%&gt;%</span><span class="w">
  </span><span class="n">filter</span><span class="p">(</span><span class="n">db</span><span class="w"> </span><span class="o">!=</span><span class="w"> </span><span class="s2">"BioTIME"</span><span class="w"> </span><span class="o">&amp;</span><span class="w"> </span><span class="n">db</span><span class="w"> </span><span class="o">!=</span><span class="w"> </span><span class="s2">"SedTraps"</span><span class="p">)</span><span class="w"> </span><span class="c1">## filtering to exclude modern data</span><span class="w">

</span><span class="n">mean</span><span class="p">(</span><span class="n">fossil</span><span class="o">$</span><span class="n">age</span><span class="p">)</span><span class="w"> 
</span></code></pre></div></div>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>[1] 5087525
</code></pre></div></div>

<p>For additional analyses and visualization, data summarization and
manipulation can be done as follows:</p>

<div class="language-r highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1">## this manipulation summarizes information for each unique time series</span><span class="w">
</span><span class="n">overview</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">bdt</span><span class="w"> </span><span class="o">%&gt;%</span><span class="w"> 
  </span><span class="n">group_by</span><span class="p">(</span><span class="n">seriesID</span><span class="p">)</span><span class="w"> </span><span class="o">%&gt;%</span><span class="w">
  </span><span class="n">dplyr</span><span class="o">::</span><span class="n">summarise</span><span class="p">(</span><span class="n">db</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">unique</span><span class="p">(</span><span class="n">db</span><span class="p">),</span><span class="w"> </span><span class="c1">## source database</span><span class="w">
                   </span><span class="c1">#environment = unique(environment), ## broadly defined environment</span><span class="w">
                   </span><span class="n">group</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">unique</span><span class="p">(</span><span class="n">group</span><span class="p">),</span><span class="w"> </span><span class="c1">## taxonomic group</span><span class="w">
                   </span><span class="n">lat</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">unique</span><span class="p">(</span><span class="n">lat</span><span class="p">),</span><span class="w"> </span><span class="c1">## latitude</span><span class="w">
                   </span><span class="n">long</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">unique</span><span class="p">(</span><span class="n">long</span><span class="p">),</span><span class="w"> </span><span class="c1">## longitude</span><span class="w">
                   </span><span class="c1">#abundType = unique(abundanceUnit), ## abundance type of records</span><span class="w">
                   </span><span class="n">samples</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">length</span><span class="p">(</span><span class="n">unique</span><span class="p">(</span><span class="n">sampleID</span><span class="p">)),</span><span class="w"> </span><span class="c1">## number of samples</span><span class="w">
                   </span><span class="n">richness</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">length</span><span class="p">(</span><span class="n">unique</span><span class="p">(</span><span class="n">analyzedTaxon</span><span class="p">)),</span><span class="w"> </span><span class="c1">## number of unique species</span><span class="w">
                   </span><span class="n">meanAge</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">mean</span><span class="p">(</span><span class="n">age</span><span class="p">,</span><span class="w"> </span><span class="n">na.rm</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kc">TRUE</span><span class="p">),</span><span class="w"> </span><span class="c1">## mean age of samples </span><span class="w">
                   </span><span class="n">minAge</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">min</span><span class="p">(</span><span class="n">age</span><span class="p">,</span><span class="w"> </span><span class="n">na.rm</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kc">TRUE</span><span class="p">),</span><span class="w"> </span><span class="c1">## minimum age of a sample</span><span class="w">
                   </span><span class="n">maxAge</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">max</span><span class="p">(</span><span class="n">age</span><span class="p">,</span><span class="w"> </span><span class="n">na.rm</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kc">TRUE</span><span class="p">),</span><span class="w"> </span><span class="c1">## maximum age of a sample</span><span class="w">
                   </span><span class="n">extent</span><span class="w"> </span><span class="o">=</span><span class="w">  </span><span class="n">maxAge</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">minAge</span><span class="p">)</span><span class="w"> </span><span class="c1">## temporal extent (duration) of the time series</span><span class="w">
</span></code></pre></div></div>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>`summarise()` has grouped output by 'seriesID'. You can override using the
`.groups` argument.
</code></pre></div></div>

<h2 id="visualizing-the-data">Visualizing the data</h2>

<p>Create a donut plot showing the contribution of source databases to
BioDeepTime:</p>

<div class="language-r highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1">## donut plot for proportion contribution of each database</span><span class="w">
</span><span class="n">databases</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">overview</span><span class="w"> </span><span class="o">%&gt;%</span><span class="w">
  </span><span class="n">group_by</span><span class="p">(</span><span class="n">db</span><span class="p">)</span><span class="w"> </span><span class="o">%&gt;%</span><span class="w">
  </span><span class="n">dplyr</span><span class="o">::</span><span class="n">summarise</span><span class="p">(</span><span class="n">count</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">n</span><span class="p">())</span><span class="w">

</span><span class="c1"># Compute percentages</span><span class="w">
</span><span class="n">databases</span><span class="o">$</span><span class="n">fraction</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">databases</span><span class="o">$</span><span class="n">count</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="nf">sum</span><span class="p">(</span><span class="n">databases</span><span class="o">$</span><span class="n">count</span><span class="p">)</span><span class="w">

</span><span class="c1"># Compute the cumulative percentages (top of each rectangle)</span><span class="w">
</span><span class="n">databases</span><span class="o">$</span><span class="n">ymax</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">cumsum</span><span class="p">(</span><span class="n">databases</span><span class="o">$</span><span class="n">fraction</span><span class="p">)</span><span class="w">

</span><span class="c1"># Compute the bottom of each rectangle</span><span class="w">
</span><span class="n">databases</span><span class="o">$</span><span class="n">ymin</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">c</span><span class="p">(</span><span class="m">0</span><span class="p">,</span><span class="w"> </span><span class="n">head</span><span class="p">(</span><span class="n">databases</span><span class="o">$</span><span class="n">ymax</span><span class="p">,</span><span class="w"> </span><span class="n">n</span><span class="o">=</span><span class="m">-1</span><span class="p">))</span><span class="w">

</span><span class="c1"># Compute label position</span><span class="w">
</span><span class="n">databases</span><span class="o">$</span><span class="n">labelPosition</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="p">(</span><span class="n">databases</span><span class="o">$</span><span class="n">ymax</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">databases</span><span class="o">$</span><span class="n">ymin</span><span class="p">)</span><span class="o">/</span><span class="m">2</span><span class="w">

</span><span class="c1"># Compute a good label</span><span class="w">
</span><span class="n">databases</span><span class="o">$</span><span class="n">label</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">paste0</span><span class="p">(</span><span class="n">databases</span><span class="o">$</span><span class="n">db</span><span class="p">,</span><span class="w"> </span><span class="s2">", "</span><span class="p">,</span><span class="w"> </span><span class="n">databases</span><span class="o">$</span><span class="n">count</span><span class="p">)</span><span class="w">

</span><span class="c1"># # Make the plot</span><span class="w">
</span><span class="c1"># ggplot(databases, aes(ymax=ymax, ymin=ymin, xmax=4, xmin=3, fill=db)) +</span><span class="w">
</span><span class="c1">#   geom_rect() +</span><span class="w">
</span><span class="c1">#   #geom_text(x=2, aes(y=labelPosition, label=label), size=6) + ## x here controls label position (inner / outer)</span><span class="w">
</span><span class="c1">#   scale_fill_manual(values = colors) +</span><span class="w">
</span><span class="c1">#   coord_polar(theta="y") +</span><span class="w">
</span><span class="c1">#   xlim(c(2, 4)) +</span><span class="w">
</span><span class="c1">#   theme_void()# +</span><span class="w">
</span><span class="c1">#   #theme(legend.position = "none") ## controls the presence of a legend</span><span class="w">
</span></code></pre></div></div>

</div>

                </div>
                
            </div>
        </div>
    </section>
    
        <footer class="footer">
    <div class="container">
        
        
        <div class="columns is-multiline">
            
            <div class="column has-text-centered">
                <div>
                    <a href="/" class="link">Home</a>
                </div>
            </div>
            
            <div class="column has-text-centered">
                <div>
                    <a href="/imprint/" class="link">Imprint</a>
                </div>
            </div>
            
        </div>
        

        <div class="content is-small has-text-centered">

        </div>
    </div>
</footer>

    
    <script src="/assets/js/app.js" type="text/javascript"></script><!-- footer scripts --></body>
</html>
